!!!
%haml{:lang => "ja"}
  %head
    %meta{:charset => "UTF-8"}
    %link{:rel => "stylesheet", :href => "css/basic.css"}
    %link{:href=>"//maxcdn.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css", :rel=>"stylesheet"}
    %script(src="http://code.jquery.com/jquery-1.11.1.min.js")
    %script(src="./js/jquery.parse.min.js")
    %title Othello_Web_GUI
  %body
    %div#board_div
    / %p= hello
  :javascript
      var csv_state = $.ajax('./state.csv', {
        dataType: 'text',
        error: function(xhr, message){
          console.log('CSV file cannot be found', message);
          allert('error');
        },
        success: function(data){
          csv = $.parse(data, {
              delimeter: ',',
              header: false
            });
          },
          async: false
        });
      var lines = csv_state.responseText.split("\n");
      var board_len = lines[0].split(",").length;
      var index, arr;
      var state = [];
      for(var k = 0; k < board_len; ++k){
        var new_line = [];
        for(var i = 0; i < board_len; ++i){
          var line = lines[i].split(",");
          new_line.push(line[k]);
        }
        state.push(new_line);
      }
      var str_accum = [];
      str_accum.push("<table>");

      var str_state = ["white", "empty", "black", "out"];
      for(var y = 0; y < board_len; ++y){
        str_accum.push("<tr>");
        if( y !== 0 ){
          str_accum.push("<th>" + "01234567890"[y] + "</th>");
        }else{
          str_accum.push("<th> </th>");
        }
        for(var x = 0; x < board_len; ++x){
          if( x !== 0 ){
            if( y === 0 ){
              str_accum.push("<th>" + "Xabcdefghij"[x] + "</th>")
            }else {
              str_accum.push("<td id='"+ x + "" + y +"' class='cell' >");
              var nm = str_state[ parseInt(state[x][y]) + 1 ];
              console.log(nm);
              str_accum.push("<span class='piece ");
              str_accum.push(nm);
              str_accum.push("'></span></td>");
            }
          }
        }

        str_accum.push("</tr>");
      }
      str_accum.push("</table>");
      $("#board_div").append(str_accum.join(''));

